# LSTMFE




### å¿«é€Ÿå¼€å§‹ (3æ­¥å³å¯å¤ç°)

```bash
# 1. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 2. ä¸€é”®å¤ç°æœ€ä½³ç»“æœ (æ¨èPEMS07æ•°æ®é›†)
python reproduce_best_results.py PEMS07

# 3. éªŒè¯ç»“æœ
python test.py
```

## ğŸ“Š æœŸæœ›ç»“æœ

| æ•°æ®é›† | æœ€ä½³ç»“æœ MAE | å¤ç°èŒƒå›´ MAE | æœ€ä½³ç»“æœ MAPE | å¤ç°èŒƒå›´ MAPE |
|--------|-------------|-------------|--------------|-------------|
| PEMS07 | 16.63 | 16.0-17.5 | 7.79% | 7.5-8.5% |
| PEMS08 | 12.47 | 12.0-13.5 | 9.04% | 8.5-10.0% |
| PEMS03 | TBD | TBD | TBD% | TBD% |
| PEMS04 | TBD | TBD | TBD% | TBD% |

**ğŸ“ è¯´æ˜**: 
- **æœ€ä½³ç»“æœ**: ä½œè€…å¤šæ¬¡è®­ç»ƒå¾—åˆ°çš„æœ€ä¼˜å€¼
- **å¤ç°èŒƒå›´**: è€ƒè™‘è®­ç»ƒéšæœºæ€§çš„åˆç†æœŸæœ›èŒƒå›´
- å¦‚æœæ‚¨çš„ç»“æœåœ¨èŒƒå›´å†…ï¼Œè¯´æ˜å¤ç°æˆåŠŸ
- å¦‚æœåå·®è¾ƒå¤§ï¼Œå»ºè®®è¿è¡Œ2-3æ¬¡å–æœ€ä½³ç»“æœ

## ğŸ“ æ•°æ®é›†å‡†å¤‡

ç¡®ä¿æ•°æ®é›†æŒ‰ä»¥ä¸‹ç»“æ„æ”¾ç½®ï¼š

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ PEMS03/
â”‚   â”œâ”€â”€ PEMS03.npz        # äº¤é€šæµæ•°æ®
â”‚   â””â”€â”€ adj.npy           # é‚»æ¥çŸ©é˜µ (å¯é€‰ï¼Œç¼ºå¤±æ—¶è‡ªåŠ¨ç”Ÿæˆ)
â”œâ”€â”€ PEMS04/
â”‚   â”œâ”€â”€ PEMS04.npz
â”‚   â””â”€â”€ adj.npy
â”œâ”€â”€ PEMS07/
â”‚   â”œâ”€â”€ PEMS07.npz
â”‚   â””â”€â”€ adj.npy
â”œâ”€â”€ PEMS08/
â”‚   â”œâ”€â”€ PEMS08.npz
â”‚   â””â”€â”€ adj.npy
â””â”€â”€ ...
```

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- **Python**: >= 3.7
- **PyTorch**: >= 1.9.0
- **CUDA**: å»ºè®®ä½¿ç”¨GPUåŠ é€Ÿ (å¯é€‰)

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ä¸€é”®å¤ç° (æ¨è)

```bash
# ä½¿ç”¨æœ€ä½³é…ç½®è®­ç»ƒæŒ‡å®šæ•°æ®é›†
python reproduce_best_results.py PEMS07

# æˆ–è€…è®©è„šæœ¬è‡ªåŠ¨é€‰æ‹©å¯ç”¨æ•°æ®é›†
python reproduce_best_results.py
```

### æ–¹æ³•2: è‡ªå®šä¹‰è®­ç»ƒ

```bash
# åŸºç¡€è®­ç»ƒ
python train.py

# æµ‹è¯•å·²è®­ç»ƒæ¨¡å‹
python test.py
```

### æ–¹æ³•3: äº¤äº’å¼è®­ç»ƒ

```python
from train import train_and_evaluate
from best_config import get_best_config

# è·å–æœ€ä½³é…ç½®
config = get_best_config('PEMS07')

# è®­ç»ƒæ¨¡å‹
results = train_and_evaluate(
    dataset='PEMS07',
    **{k: v for k, v in config.items() if k != 'expected_results'}
)

print(f"MAE: {results['MAE']:.4f}")
```

## ğŸ“ˆ æ¨¡å‹æ¶æ„

æœ¬æ¨¡å‹åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼š

1. **Module 1: Multiscale Temporal Feature Extraction (MTFE)**
   - åŸºäºEinFFTçš„å¤šå°ºåº¦æ—¶é—´ç‰¹å¾æå–
   - è‡ªåŠ¨å‘¨æœŸæ£€æµ‹å’Œé¢‘åŸŸå¢å¼º

2. **Module 2: Graph-Enhanced Coordinate Attention (GECA)**
   - åˆ‡æ¯”é›ªå¤«å›¾å·ç§¯ç½‘ç»œ
   - åæ ‡æ³¨æ„åŠ›æœºåˆ¶

3. **Module 3: Time-aware Decomposition (TATSD)**
   - æ—¶é—´æ„ŸçŸ¥çš„è¶‹åŠ¿å­£èŠ‚åˆ†è§£
   - è‡ªé€‚åº”æƒé‡å­¦ä¹ 

## ğŸ›ï¸ å…³é”®è¶…å‚æ•°

```python
BEST_PARAMS = {
    'd_model': 96,           # æ¨¡å‹ç»´åº¦
    'decoder_layers': 3,     # è§£ç å™¨å±‚æ•°
    'seq_len': 12,          # è¾“å…¥åºåˆ—é•¿åº¦
    'batch_size': 32,       # æ‰¹æ¬¡å¤§å°
    'epochs': 300,          # è®­ç»ƒè½®æ•°
    'learning_rate': 1e-3,  # å­¦ä¹ ç‡
    'top_k': 3,             # ä¸»è¦é¢‘ç‡æ•°é‡
    'use_decomposition': True,    # æ˜¯å¦ä½¿ç”¨åˆ†è§£æ¨¡å—
    'decomp_weight': 0.1,   # åˆ†è§£æ¨¡å—æƒé‡
}
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®é›†æœªæ‰¾åˆ°**
   ```
   è§£å†³æ–¹æ¡ˆ: ç¡®ä¿æ•°æ®é›†æ–‡ä»¶åå’Œè·¯å¾„æ­£ç¡®
   ```

2. **CUDAå†…å­˜ä¸è¶³**
   ```bash
   # å‡å°æ‰¹æ¬¡å¤§å°
   python reproduce_best_results.py PEMS07 --batch_size 16
   ```

3. **ç»“æœå·®å¼‚è¾ƒå¤§**
   ```
   å¯èƒ½åŸå› : 
   - ç¡¬ä»¶å·®å¼‚å¯¼è‡´çš„æ•°å€¼ç²¾åº¦å·®å¼‚
   - PyTorchç‰ˆæœ¬ä¸åŒ
   - éšæœºç§å­å½±å“
   ```

### æ€§èƒ½ä¼˜åŒ–

- **GPUåŠ é€Ÿ**: è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨CUDA
- **æ··åˆç²¾åº¦**: å¯åœ¨ä»£ç ä¸­å¯ç”¨AMPåŠ é€Ÿè®­ç»ƒ
- **æ‰¹æ¬¡å¤§å°**: æ ¹æ®æ˜¾å­˜è°ƒæ•´batch_size

## ğŸ“Š å®éªŒå¤ç°

### å®Œæ•´å¤ç°æµç¨‹

1. **ç¯å¢ƒè®¾ç½®**
   ```bash
   conda create -n st-mtfe python=3.8
   conda activate st-mtfe
   pip install -r requirements.txt
   ```

2. **æ•°æ®å‡†å¤‡** 
   - ä¸‹è½½PEMSæ•°æ®é›†
   - æ”¾ç½®åœ¨æ­£ç¡®ç›®å½•ç»“æ„ä¸­

3. **è®­ç»ƒæ¨¡å‹**
   ```bash
   python reproduce_best_results.py PEMS07
   ```

4. **éªŒè¯ç»“æœ**
   ```bash
   python test.py
   ```

### é¢„æœŸè®­ç»ƒæ—¶é—´

| æ•°æ®é›† | GPU (V100) | CPU | å†…å­˜ä½¿ç”¨ |
|--------|------------|-----|----------|
| PEMS03 | ~2å°æ—¶     | ~8å°æ—¶ | ~4GB |
| PEMS04 | ~3å°æ—¶     | ~12å°æ—¶ | ~6GB |
| PEMS07 | ~2.5å°æ—¶   | ~10å°æ—¶ | ~5GB |
| PEMS08 | ~3.5å°æ—¶   | ~14å°æ—¶ | ~7GB |

## ğŸ“ å¼•ç”¨

å¦‚æœè¿™ä¸ªä»£ç å¯¹æ‚¨çš„ç ”ç©¶æœ‰å¸®åŠ©ï¼Œè¯·å¼•ç”¨æˆ‘ä»¬çš„è®ºæ–‡ï¼š

```bibtex
@article{your_paper_2024,
  title={Your Paper Title},
  author={Your Name},
  journal={Your Journal},
  year={2024}
}
```

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
- æäº¤Issueåˆ°GitHubä»“åº“
- å‘é€é‚®ä»¶è‡³ï¼šyour.email@example.com

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºæ­¤é¡¹ç›®åšå‡ºè´¡çŒ®çš„ç ”ç©¶è€…å’Œå¼€å‘è€…ã€‚

---
**æœ€åæ›´æ–°**: 2024å¹´7æœˆ30æ—¥
Dataset link: https://github.com/HITPLZ/DSTRformer
